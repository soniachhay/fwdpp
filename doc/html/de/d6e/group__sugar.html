<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>fwdpp: Syntactic sugar layer</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">fwdpp
   &#160;<span id="projectnumber">0.8.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Syntactic sugar layer</div>  </div>
</div><!--header-->
<div class="contents">

<p>Syntactic sugar for easier development of simulations.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df7/structfwdpp_1_1popgenmut.html">fwdpp::popgenmut</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutations with selection, dominance, and tracking age of origin The "standard" mutation type for population genetic simulation. A mutation has its own selection and dominance coefficients.  <a href="../../d9/df7/structfwdpp_1_1popgenmut.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga628c1455363b18bbe2cbfdfb71f68457"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6e/group__sugar.html#ga628c1455363b18bbe2cbfdfb71f68457">fwdpp::gsl::gsl_rng_ptr_t</a> = std::unique_ptr&lt; gsl_rng, void(*)(gsl_rng *)&gt;</td></tr>
<tr class="memdesc:ga628c1455363b18bbe2cbfdfb71f68457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Smart pointer wrapper to gsl_rng *.  <a href="../../de/d6e/group__sugar.html#ga628c1455363b18bbe2cbfdfb71f68457">More...</a><br /></td></tr>
<tr class="separator:ga628c1455363b18bbe2cbfdfb71f68457"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9ad80c1a4bb0468a7e4de05f3126458c"><td class="memTemplParams" colspan="2">template&lt;typename mcont_t , typename mcounts_t &gt; </td></tr>
<tr class="memitem:ga9ad80c1a4bb0468a7e4de05f3126458c"><td class="memTemplItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../de/d6e/group__sugar.html#ga9ad80c1a4bb0468a7e4de05f3126458c">fwdpp::sugar::get_mut_index</a> (mcont_t &amp;mutations, mcounts_t &amp;mcounts, typename mcont_t::value_type &amp;new_mutation)</td></tr>
<tr class="memdesc:ga9ad80c1a4bb0468a7e4de05f3126458c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function for implementing <a class="el" href="../../de/d6e/group__sugar.html#ga3f5ed6b83bb2814905e08054587a7e51" title="Add a mutation into a population at a given frequency. ">fwdpp::add_mutation</a>.  <a href="../../de/d6e/group__sugar.html#ga9ad80c1a4bb0468a7e4de05f3126458c">More...</a><br /></td></tr>
<tr class="separator:ga9ad80c1a4bb0468a7e4de05f3126458c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f5ed6b83bb2814905e08054587a7e51"><td class="memTemplParams" colspan="2">template&lt;typename poptype , class... Args&gt; </td></tr>
<tr class="memitem:ga3f5ed6b83bb2814905e08054587a7e51"><td class="memTemplItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../de/d6e/group__sugar.html#ga3f5ed6b83bb2814905e08054587a7e51">fwdpp::add_mutation</a> (<a class="el" href="../../d2/df8/spatialts_8cc.html#af42af3a583005f9b1db56c61a5bdd18a">poptype</a> &amp;p, const std::vector&lt; std::size_t &gt; &amp;indlist, const std::vector&lt; short &gt; &amp;clist, Args &amp;&amp;... args)</td></tr>
<tr class="memdesc:ga3f5ed6b83bb2814905e08054587a7e51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a mutation into a population at a given frequency.  <a href="../../de/d6e/group__sugar.html#ga3f5ed6b83bb2814905e08054587a7e51">More...</a><br /></td></tr>
<tr class="separator:ga3f5ed6b83bb2814905e08054587a7e51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab05d410c9eb46a7832e073a0582c982"><td class="memTemplParams" colspan="2">template&lt;typename poptype &gt; </td></tr>
<tr class="memitem:gaab05d410c9eb46a7832e073a0582c982"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../de/d6e/group__sugar.html#gaab05d410c9eb46a7832e073a0582c982">fwdpp::add_mutations</a> (<a class="el" href="../../d2/df8/spatialts_8cc.html#af42af3a583005f9b1db56c61a5bdd18a">poptype</a> &amp;p, const std::vector&lt; std::size_t &gt; &amp;indlist, const std::vector&lt; short &gt; &amp;clist, const std::vector&lt; std::size_t &gt; &amp;mutation_indexes)</td></tr>
<tr class="memdesc:gaab05d410c9eb46a7832e073a0582c982"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a set of mutations into a set of individuals in a population.  <a href="../../de/d6e/group__sugar.html#gaab05d410c9eb46a7832e073a0582c982">More...</a><br /></td></tr>
<tr class="separator:gaab05d410c9eb46a7832e073a0582c982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa221492829e317e96c485621115c9361"><td class="memTemplParams" colspan="2">template&lt;typename poptype &gt; </td></tr>
<tr class="memitem:gaa221492829e317e96c485621115c9361"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../de/d6e/group__sugar.html#gaa221492829e317e96c485621115c9361">fwdpp::change_neutral</a> (<a class="el" href="../../d2/df8/spatialts_8cc.html#af42af3a583005f9b1db56c61a5bdd18a">poptype</a> &amp;p, const std::size_t mindex)</td></tr>
<tr class="memdesc:gaa221492829e317e96c485621115c9361"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the value of <a class="el" href="../../da/dca/structfwdpp_1_1mutation__base.html#ab816e51903e630e17539cd766d1e259a" title="Is the mutation neutral or not? ">mutation_base::neutral</a>.  <a href="../../de/d6e/group__sugar.html#gaa221492829e317e96c485621115c9361">More...</a><br /></td></tr>
<tr class="separator:gaa221492829e317e96c485621115c9361"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Syntactic sugar for easier development of simulations. </p>
<p>See <a class="el" href="../../db/dd8/md_md_sugar.html">Tutorial 5: the "sugar" layer on top of fwdpp</a> for a full description of the features that fwdpp's sugar layer provides. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga628c1455363b18bbe2cbfdfb71f68457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga628c1455363b18bbe2cbfdfb71f68457">&#9670;&nbsp;</a></span>gsl_rng_ptr_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../de/d6e/group__sugar.html#ga628c1455363b18bbe2cbfdfb71f68457">fwdpp::gsl::gsl_rng_ptr_t</a> = typedef std::unique_ptr&lt;gsl_rng, void (*)(gsl_rng *)&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Smart pointer wrapper to gsl_rng *. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d16/deleter_8hpp_source.html#l00015">15</a> of file <a class="el" href="../../da/d16/deleter_8hpp_source.html">deleter.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga3f5ed6b83bb2814905e08054587a7e51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3f5ed6b83bb2814905e08054587a7e51">&#9670;&nbsp;</a></span>add_mutation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename poptype , class... Args&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::size_t fwdpp::add_mutation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/df8/spatialts_8cc.html#af42af3a583005f9b1db56c61a5bdd18a">poptype</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>indlist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; short &gt; &amp;&#160;</td>
          <td class="paramname"><em>clist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Args &amp;&amp;...&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a mutation into a population at a given frequency. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>A single locus population object. </td></tr>
    <tr><td class="paramname">indlist</td><td>A list of indexes of diploids into which to add the new mutations. </td></tr>
    <tr><td class="paramname">clist</td><td>A list of haploid_genomes. See below. </td></tr>
    <tr><td class="paramname">args</td><td>Values required to cosnstruct a new mutation. See below.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The key referring to the location of the new mutation in the population</dd></dl>
<p>Some notes:</p>
<p>clist.size() must equal indlist.size()</p>
<p>Values in <em>clist</em> must be 0, 1, or 2. These values mean to add the mutation to the first, second, or both haploid_genomes, resepectively, of each diploid in <em>indlist</em>.</p>
<p>Note that <em>args</em> can take on a few different forms. First, it can be a raw set of values used to construct a new mutation. Or, it can be an object of correct mutation type. Or, it can be any type from which the correct mutation type can be constructed. The last two cases require that the mutation type have the appropriate constructors defined.</p>
<p>See the unit test file unit/test_sugar_add_mutation.cc for example of use. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d87/add__mutation_8hpp_source.html#l00193">193</a> of file <a class="el" href="../../d1/d87/add__mutation_8hpp_source.html">add_mutation.hpp</a>.</p>

</div>
</div>
<a id="gaab05d410c9eb46a7832e073a0582c982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaab05d410c9eb46a7832e073a0582c982">&#9670;&nbsp;</a></span>add_mutations()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename poptype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void fwdpp::add_mutations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/df8/spatialts_8cc.html#af42af3a583005f9b1db56c61a5bdd18a">poptype</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>indlist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; short &gt; &amp;&#160;</td>
          <td class="paramname"><em>clist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>mutation_indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a set of mutations into a set of individuals in a population. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>A diploid population object. </td></tr>
    <tr><td class="paramname">indlist</td><td>A list of indexes of diploids into which to add the new mutations. </td></tr>
    <tr><td class="paramname">clist</td><td>A list of haploid_genomes. See below. </td></tr>
    <tr><td class="paramname">mutation_indexes</td><td>The set of mutations to add. See below.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing (void)</dd></dl>
<p>Some notes:</p>
<p>clist.size() must equal indlist.size()</p>
<p>Values in <em>clist</em> must be 0, 1, or 2. These values mean to add the mutation to the first, second, or both haploid_genomes, resepectively, of each diploid in <em>indlist</em>.</p>
<dl class="section note"><dt>Note</dt><dd><em>mutation_indexes</em> refers to the locations of mutations found in <em>p.mutations</em>.</dd>
<dd>
For each element, i, in <em>mutation_indexes</em>, <em>p.mcounts</em>[i] should be zero before entering this function.</dd>
<dd>
<em>p.mut_lookup</em> is NOT updated by this function.</dd></dl>
<p>See the unit test file unit/test_sugar_add_mutation.cc for example of use. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d87/add__mutation_8hpp_source.html#l00261">261</a> of file <a class="el" href="../../d1/d87/add__mutation_8hpp_source.html">add_mutation.hpp</a>.</p>

</div>
</div>
<a id="gaa221492829e317e96c485621115c9361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa221492829e317e96c485621115c9361">&#9670;&nbsp;</a></span>change_neutral()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename poptype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void fwdpp::change_neutral </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/df8/spatialts_8cc.html#af42af3a583005f9b1db56c61a5bdd18a">poptype</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>mindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change the value of <a class="el" href="../../da/dca/structfwdpp_1_1mutation__base.html#ab816e51903e630e17539cd766d1e259a" title="Is the mutation neutral or not? ">mutation_base::neutral</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>A population </td></tr>
    <tr><td class="paramname">mindex</td><td>The key of the mutation you wish to change.</td></tr>
  </table>
  </dd>
</dl>
<p>This function negates <a class="el" href="../../da/dca/structfwdpp_1_1mutation__base.html#ab816e51903e630e17539cd766d1e259a" title="Is the mutation neutral or not? ">mutation_base::neutral</a> at position mindex and updates the storage of this mutation in all haploid_genomes.</p>
<dl class="section note"><dt>Note</dt><dd>This function does not change any other member data at p.mutations[mindex]!! Thus, if you change a mutation from "neutral" to "selected", you must manually change the relevant member data to reflect its new effect size. For the simplest use case of making a mutation no longer subject to selection, no additional changes are needed. Rather, it is sufficient that <a class="el" href="../../da/dca/structfwdpp_1_1mutation__base.html#ab816e51903e630e17539cd766d1e259a" title="Is the mutation neutral or not? ">mutation_base::neutral</a> == true.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::out_of_range</td><td>if <em>mindex</em> is out of range. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/dcb/change__neutral_8hpp_source.html#l00054">54</a> of file <a class="el" href="../../dd/dcb/change__neutral_8hpp_source.html">change_neutral.hpp</a>.</p>

</div>
</div>
<a id="ga9ad80c1a4bb0468a7e4de05f3126458c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ad80c1a4bb0468a7e4de05f3126458c">&#9670;&nbsp;</a></span>get_mut_index()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename mcont_t , typename mcounts_t &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::size_t fwdpp::sugar::get_mut_index </td>
          <td>(</td>
          <td class="paramtype">mcont_t &amp;&#160;</td>
          <td class="paramname"><em>mutations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mcounts_t &amp;&#160;</td>
          <td class="paramname"><em>mcounts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typename mcont_t::value_type &amp;&#160;</td>
          <td class="paramname"><em>new_mutation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function for implementing <a class="el" href="../../de/d6e/group__sugar.html#ga3f5ed6b83bb2814905e08054587a7e51" title="Add a mutation into a population at a given frequency. ">fwdpp::add_mutation</a>. </p>
<p>If <em>new_mutation</em> already exists in <em>mutations</em>, its location is returned.</p>
<p>Otherwise, this function puts the new mutation into the mutations container and updates other objects as needed.</p>
<dl class="section return"><dt>Returns</dt><dd>A key telling where <em>new_mutation</em> exists within <em>mutations</em>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function requires that operator== be defined for the mutation type.</dd>
<dd>
In the event that <em>new_mutation</em> is added to <em>mutations</em>, the count for that mutations will be zero. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d87/add__mutation_8hpp_source.html#l00027">27</a> of file <a class="el" href="../../d1/d87/add__mutation_8hpp_source.html">add_mutation.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
